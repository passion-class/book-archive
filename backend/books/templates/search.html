
{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <link href="{% static 'books/css/search.css' %}" rel="stylesheet">
  <title>ì±… ê²€ìƒ‰ ë° ì„ íƒ ì €ì¥</title>
</head>
<body>
  <div class="background">
    <h1>ì—¬ê¸°ëŠ” ë‹¹ì‹ ì˜ ì„œì¬,</h1>
    <p>ì–´ë–¤ ì±…ì„ ê°€ì§€ê³  ìˆëŠ”ì§€,<br>ì–´ë–¤ ì·¨í–¥ì„ ê°€ì§€ê³  ìˆëŠ”ì§€.</p>

    <h3>ğŸ“š ì±… ì œëª©ì„ ì…ë ¥í•˜ì„¸ìš” ğŸ“š</h3>

    <!-- ğŸ” ê²€ìƒ‰ í¼ -->
    <form method="post">
      {% csrf_token %}
      <!-- <input type="text" name="title" id="id_title" placeholder="ìµœëŒ€í•œ ì •í™•í•˜ê²Œ ì…ë ¥í•´ì£¼ì„¸ìš”."> -->
      {{ form.as_p }}
      <button type="submit" name="search" class="but">ì±… ê²€ìƒ‰</button>
    </form>

    <!-- âœ… ê²€ìƒ‰ ê²°ê³¼ ìˆìœ¼ë©´ ì¶œë ¥ -->

      <hr>
      <h2>ê²€ìƒ‰ ê²°ê³¼</h2>

    <form method="post" action="{% url 'book:save_selected_books' %}">
        {% csrf_token %}

        {% for book in books %}
          <div>
            <input type="checkbox" name="selected_books" value="{{ book.isbn }}">
            <strong>{{ book.title }}</strong><br>
            <em>{{ book.authors }}</em><br>
            <small>{{ book.publisher }} / {{ book.published_date }}</small><br>
            {% if book.thumbnail %}
              <img src="{{ book.thumbnail }}" width="100"><br>
            {% endif %}
            {{ book.description|truncatechars:300 }}
          </div>
        {% endfor %}
        <input type="hidden" name="book_data_json" id="bookDataJson">
        <button type="submit" class="but">ì„œì¬ì— ì €ì¥</button>
    </form>
  </div>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        try {
          const rawJson = '{{ book_data_json|escapejs }}';
          const bookData = JSON.parse(rawJson);
          const input = document.getElementById("bookDataJson");
          input.value = JSON.stringify(bookData);
        } catch (e) {
          console.error("book_data_json ë Œë”ë§ ì˜¤ë¥˜:", e);
        }
      });
    </script>
</body>
</html>
